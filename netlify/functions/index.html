<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src https://*; child-src 'none';">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Servidor socke io</title>
</head>
<body>
   <div><h1> esta es la carpeta de netlify prueba de socket io</h1>
<div id="welcome"></div>
<div id="codigo"></div>
<div id="hola"></div>
<button id="consulta">consulta</button>
<div>
el resultado es <span id="resultado"></span>
</div>
<div><button id="saludar">Saludar</button></div>
</div>
<script src="https://cdn.socket.io/4.4.1/socket.io.esm.min.js"></script>
<script src="./socket.io/socket.io.js"></script>
 
    <script>
      const socket=io();
const saludar=document.querySelector("#saludar");
const consulta= document.querySelector("#consulta")
const resultado=document.querySelector("#resultado")

socket.on("welcome",data=>{
    const welcome=document.querySelector("#welcome");
    welcome.innerHTML=data;

})

saludar.addEventListener("click",()=>{
socket.emit("server","hola");
})

socket.on("todos",data=>{
    const codigo=document.querySelector("#codigo");
    codigo.innerHTML=data;

})

socket.on("hola",data=>{
    const hola=document.querySelector("#hola");
    hola.innerHTML=data;
    setInterval(()=>{
        hola.innerHTML="";
    }
       
    ,6000)

})

consulta.addEventListener("click",()=>{
    const id=socket.id;
    const data = {
        id:1,
        user:id
    }
    socket.emit("consulta",data);
    })

    socket.on("consultabd",data=>{
                
        async function load() {
            const res = await fetch(`http://localhost:8000/peliculas/+${data.id}`);
      
          
           const datas = await res.json();
        
            if (res.status === 201) {
                console.log("ff");
              socket.emit("reultadoserver",datas)
            }
          }

          load() ;
    })
    socket.on("resultadocliente",data=>{
            console.log(data)
        resultado.innerHTML=data.overview;
    })
    
    </script>
</body>
</html>